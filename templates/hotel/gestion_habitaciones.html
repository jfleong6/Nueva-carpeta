<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GestiÃ³n de Habitaciones</title>
  <link rel="stylesheet" href="/static/css/gestion_habitaciones.css">
</head>

<body>

  <header class="sticky-header">
    <div class="header-content">
      <div class="search-box">
        <span class="icon">ğŸ”</span>
        <input type="text" id="buscador" placeholder="Buscar habitaciÃ³n..." onkeyup="filtrarTabla()">
      </div>

      <div class="filtros-grupo">
        <button class="filter-pill active" onclick="filtrarEstado('todos')">Todas</button>
        <button class="filter-pill" onclick="filtrarEstado('1')">ğŸŸ¢ Disp.</button>
        <button class="filter-pill" onclick="filtrarEstado('3')">ğŸ§¹ Aseo</button>
        <button class="filter-pill" onclick="filtrarEstado('2')">ğŸ”´ Ocup.</button>
        <button class="filter-pill" onclick="filtrarEstado('0')">ğŸš« Bloq.</button>
      </div>

      <button id="btnAgregar" class="btn-primary-header">
        <span>ï¼‹</span> Nueva HabitaciÃ³n
      </button>
    </div>
  </header>

  <div class="dashboard-container">
    <table class="tabla-gestion">
      <thead>
        <tr>
          <th>HabitaciÃ³n</th>
          <th>Tipo / Capacidad</th>
          <th>Camas</th>
          <th>Precio</th>
          <th>Estado</th>
          <th class="text-right">Acciones</th>
        </tr>
      </thead>
      <tbody id="tablaBody">
        {% for h in habitaciones %}
        <tr class="fila-habitacion" data-estado="{{ h.estado }}" data-id="{{ h.id }}">
          <td class="col-numero"><strong>{{ h.numero }}</strong></td>

          <td>
            <div class="dato-tipo">{{ h.tipo }}</div>
            <span class="dato-capacidad">ğŸ‘¤ {{ h.capacidad }} pers.</span>
          </td>

          <td class="col-camas">
            <div class="camas-wrapper">
              {% if h.cama > 0 %}
              <div class="item-cama" title="Cama Doble">
                <img src="/static/iconos/cama.png" alt="Doble">
                <span>Ã—{{ h.cama }}</span>
              </div>
              {% endif %}

              {% if h.sencilla > 0 %}
              <div class="item-cama" title="Cama Sencilla">
                <img src="/static/iconos/sencilla.png" alt="Sencilla">
                <span>Ã—{{ h.sencilla }}</span>
              </div>
              {% endif %}

              {% if h.camarote > 0 %}
              <div class="item-cama" title="Camarote">
                <img src="/static/iconos/camarote.png" alt="Camarote">
                <span>Ã—{{ h.camarote }}</span>
              </div>
              {% endif %}
            </div>
          </td>

          <td class="col-precio">$ {{ "{:,.0f}".format(h.precio_noche) }}</td>

          <td>
            {% if h.estado == '1' %} <span class="badge disponible">Disponible</span>
            {% elif h.estado == '3' %} <span class="badge aseo">Limpieza</span>
            {% elif h.estado == '0' %} <span class="badge mant">Bloqueada</span>
            {% elif h.estado == '2' %} <span class="badge ocupada">Ocupada</span>
            {% endif %}
          </td>

          <td class="text-right actions-cell">
            {% if h.estado == '3' %}
            <button class="btn-icon btn-limpiar" onclick="marcarLimpia('{{ h.numero }}')"
              title="Marcar Limpia">ğŸ§¹</button>
            {% endif %}

            {% if h.estado == '0' %}
            <button class="btn-icon" onclick="desbloquear('{{ h.id }}', '{{h.numero}}')" title="Desbloquear">ğŸ”“</button>
            {% else %}
            <button class="btn-icon btn-danger-text" onclick="abrirModalBloqueo('{{ h.id }}')"
              title="Bloquear">ğŸš«</button>
            {% endif %}

            <button class="btn-icon" onclick="editarHabitacion('{{ h.numero }}')" title="Editar">âœï¸</button>
            <button class="btn-icon" onclick="verDetalle('{{ h.numero }}')" title="Ver Detalle">ğŸ‘ï¸</button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div id="modal" class="modal-overlay">
    <div class="modal-contenido">
      <div class="modal-header">
        <h2>Nueva HabitaciÃ³n</h2>
        <span id="btnCerrar" class="cerrar-modal">&times;</span>
      </div>

      <form id="formHabitacion">
        <div class="form-group">
          <label>NÃºmero</label>
          <input type="text" name="numero" required placeholder="Ej: 901">
        </div>
        <div class="form-grid-2">
          <div class="form-group">
            <label>Tipo</label>
            <input type="text" name="tipo" required placeholder="Ej: Suite">
          </div>
          <div class="form-group">
            <label>Capacidad</label>
            <input type="number" name="capacidad" required min="1">
          </div>
        </div>

        <div class="form-group">
          <label>ConfiguraciÃ³n de Camas</label>
          <div class="camas-grid">
            <div><label>ğŸ‘‘ Dobles</label><input type="number" name="doble" value="0"></div>
            <div><label>ğŸ›ï¸ Senc.</label><input type="number" name="sencilla" value="0"></div>
            <div><label>ğŸªœ Camar.</label><input type="number" name="camarote" value="0"></div>
          </div>
        </div>

        <div class="form-group">
          <label>Precio Noche</label>
          <input type="number" step="1000" name="precio_noche" required>
        </div>

        <div class="botones-modal">
          <button type="button" class="btn-cancelar" onclick="cerrarModal()">Cancelar</button>
          <button type="submit" class="btn-guardar">Guardar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalBloqueo" class="modal-overlay">
    <div class="modal-contenido small">
      <h3>ğŸš« Bloquear HabitaciÃ³n</h3>
      <p>Selecciona el motivo del bloqueo:</p>
      <select id="motivoBloqueo" class="input-full">
        <option>Mantenimiento General</option>
        <option>ReparaciÃ³n ElÃ©ctrica</option>
        <option>Pintura</option>
      </select>
      <div class="botones-modal">
        <button class="btn-cancelar" onclick="cerrarModalBloqueo()">Cancelar</button>
        <button class="btn-guardar btn-danger-bg" onclick="confirmarBloqueo()">Bloquear</button>
      </div>
    </div>
  </div>

  <script src="/static/js/hotel/gestion_habitaciones.js"></script>
</body>

</html>